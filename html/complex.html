<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>TUChome</title>
    <link rel="stylesheet" href="style.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="bootstrap.min.css" rel="stylesheet" />
  </head>
  <body>
    <div class="header bg-dark">
      <div class="custom-icon">
        <!-- prettier-ignore -->
        <img src="../images/TUC_logo.png" alt="Custom Icon" onclick="window.electronAPI.toMap()" />
      </div>
      <div class="search-bar">
        <!-- prettier-ignore -->
        <input id="searchInput" class="form-control" type="text" placeholder="Search..." />
        <ul id="suggestions" class="list-group"></ul>
      </div>
      <div class="window-controls">
        <button id="minimize-btn" class="window-controls-btn">&#128469;</button>
        <button id="maximize-btn" class="window-controls-btn">&#128470;</button>
        <button id="close-btn" class="window-controls-btn">&#128473;</button>
      </div>
    </div>
    <div class="content">
      <div class="modal-container">
        <div class="mt-4" id="person-1">
          <div class="card">
            <!-- prettier-ignore -->
            <img src="../images/person.jpg" class="card-img-top" alt="Person's Image" />
            <div class="card-body">
              <h5 class="card-title person-name">Ονοματεπώνυμο 1</h5>
              <p class="card-text person-dept">ΣΧΟΛΗ - ΑΡΙΘΜΟΣ ΜΗΤΡΩΟΥ</p>
              <p class="card-text person-tel">Τηλ.: ΚΙΝΗΤΟ 1 - ΚΙΝΗΤΟ 2</p>
              <p class="card-text person-email">Email: example@tuc.gr</p>
              <!-- prettier-ignore -->
              <p class="card-text person-comments"> Σχόλια: Δεν υπάρχουν!</p>
            </div>
          </div>
        </div>
        <div class="mt-4" id="room-info">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title room-number">Στοιχεία δωματίου Χ:</h5>
              <p class="card-text room-id">α/α: ΧΧΧ</p>
              <p class="card-text room-type">Τύπος: Δεν υπάρχουν!</p>
              <p class="card-text room-phone">Τηλέφωνο: Δεν υπάρχουν!</p>
              <p class="card-text room-lan">Πρίζα Ίντερνετ: Δεν υπάρχουν!</p>
              <p class="card-text room-comments">Σχόλια: Δεν υπάρχουν!</p>
            </div>
          </div>
        </div>
        <div class="mt-4" id="person-2">
          <div class="card">
            <!-- prettier-ignore -->
            <img src="../images/person.jpg" class="card-img-top" alt="Person's Image" />
            <div class="card-body">
              <h5 class="card-title person-name">Ονοματεπώνυμο 2</h5>
              <p class="card-text person-dept">ΣΧΟΛΗ - ΑΡΙΘΜΟΣ ΜΗΤΡΩΟΥ</p>
              <p class="card-text person-tel">Τηλ.: ΚΙΝΗΤΟ 1 - ΚΙΝΗΤΟ 2</p>
              <p class="card-text person-email">Email: example@tuc.gr</p>
              <!-- prettier-ignore -->
              <p class="card-text person-comments"> Σχόλια: Δεν υπάρχουν!</p>
            </div>
          </div>
        </div>
      </div>
      <svg
        viewBox="0 0 1920 1080"
        version="1.1"
        id="rooms"
        xml:space="preserve"
        xmlns:xlink="http://www.w3.org/1999/xlink"
        xmlns="http://www.w3.org/2000/svg"
        xmlns:svg="http://www.w3.org/2000/svg"
      >
        <!-- prettier-ignore -->
        <g inkscape:label="Στρώση 1" inkscape:groupmode="layer" id="layer1">
          <image width="1920" height="1080" xlink:href="../images/layers.png" id="image1" />
          <a xlink:href="#" onclick="room(1)">
            <rect id="room-1" width="76.318962" height="96.578178" x="101.88075" y="939.69983" />
          </a>
          <a xlink:href="#" onclick="room(2)">
            <rect id="room-2" width="76.318962" height="96.578178" x="101.57359" y="813.69891" />
          </a>
          <a xlink:href="#" onclick="room(3)">
            <rect id="room-3" width="74.931343" height="96.578178" x="180.8463" y="939.83282" />
          </a>
          <a xlink:href="#" onclick="room(4)">
            <rect id="room-4" width="69.935921" height="96.578178" x="259.00241" y="813.57336" />
          </a>
          <a xlink:href="#" onclick="room(5)">
            <rect id="room-5" width="69.935921" height="96.578178" x="259.07108" y="939.94751" />
          </a>
          <a xlink:href="#" onclick="room(6)">
            <rect id="room-6" width="69.935921" height="96.578178" x="479.0376" y="813.4953" />
          </a>
          <a xlink:href="#" onclick="room(7)">
            <rect id="room-7" width="69.935921" height="96.578178" x="478.96893" y="939.86945" />
          </a>
          <a xlink:href="#" onclick="room(8)">
            <rect id="room-8" width="76.318962" height="96.578178" x="630.46643" y="813.62085"  />
          </a>
          <a xlink:href="#" onclick="room(9)">
            <rect id="room-9" width="74.931343" height="96.578178" x="553.19373" y="939.75476"  />
          </a>
          <a xlink:href="#" onclick="room(10)">
            <rect id="room-10" width="76.318962" height="96.578178" x="630.1593" y="939.62177"  />
          </a>
          <a xlink:href="#" onclick="room(11)">
            <rect id="room-11" width="76.318962" height="96.578178" x="306.29086" y="548.16589" />
          </a>
          <a xlink:href="#" onclick="room(12)">
            <rect id="room-12" width="76.318962" height="96.578178" x="305.9837" y="422.16498" />
          </a>
          <a xlink:href="#" onclick="room(13)">
            <rect id="room-13" width="74.931343" height="96.578178" x="385.25641" y="548.29889" />
          </a>
          <a xlink:href="#" onclick="room(14)">
            <rect id="room-14" width="69.935921" height="96.578178" x="463.41251" y="422.03943" />
          </a>
          <a xlink:href="#" onclick="room(15)">
            <rect id="room-15" width="69.935921" height="96.578178" x="463.48117" y="548.41357" />
          </a>
          <a xlink:href="#" onclick="room(16)">
            <rect id="room-16" width="69.935921" height="96.578178" x="683.44775" y="421.96136" />
          </a>
          <a xlink:href="#" onclick="room(17)">
            <rect id="toom-17" width="69.935921" height="96.578178" x="683.37909" y="548.33551"  />
          </a>
          <a xlink:href="#" onclick="room(18)">
            <rect id="room-18" width="76.318962" height="96.578178" x="834.87653" y="422.08691"  />
          </a>
          <a xlink:href="#" onclick="room(19)">
            <rect id="room-19" width="74.931343" height="96.578178" x="757.60382" y="548.22083"  />
          </a>
          <a xlink:href="#" onclick="room(20)">
            <rect id="room-20" width="76.318962" height="96.578178" x="834.5694" y="548.08783"  />
          </a>
          <a xlink:href="#" onclick="room(21)">
            <rect id="room-21" width="76.318962" height="96.578178" x="510.14777" y="161.84372" />
          </a>
          <a xlink:href="#" onclick="room(22)">
            <rect id="room-22" width="76.318962" height="96.578178" x="509.84061" y="35.842815" />
          </a>
          <a xlink:href="#" onclick="room(23)">
            <rect id="room-23" width="74.931343" height="96.578178" x="589.11298" y="161.97672" />
          </a>
          <a xlink:href="#" onclick="room(24)">
            <rect id="room-24" width="69.935921" height="96.578178" x="667.2691" y="35.717266" />
          </a>
          <a xlink:href="#" onclick="room(25)">
            <rect id="room-25" width="69.935921" height="96.578178" x="667.33777" y="162.0914" />
          </a>
          <a xlink:href="#" onclick="room(26)">
            <rect id="room-26" width="69.935921" height="96.578178" x="887.30432" y="35.639202" />
          </a>
          <a xlink:href="#" onclick="room(27)">
            <rect id="room-27" width="69.935921" height="96.578178" x="887.23566" y="162.01334" />
          </a>
          <a xlink:href="#" onclick="room(28)">
            <rect id="room-28" width="76.318962" height="96.578178" x="1038.7332" y="35.764751" />
          </a>
          <a xlink:href="#" onclick="room(29)">
            <rect id="room-29" width="74.931343" height="96.578178" x="961.4604" y="161.89865" />
          </a>
          <a xlink:href="#" onclick="room(30)">
            <rect id="room-30" width="76.318962" height="96.578178" x="1038.426" y="161.76566"/>
          </a>
          <a xlink:href="#" onclick="room(31)">
            <rect id="room-31" width="76.318962" height="96.578178" x="800.90906" y="939.67712" />
          </a>
          <a xlink:href="#" onclick="room(32)">
            <rect id="room-32" width="76.318962" height="96.578178" x="800.60193" y="813.67621" />
          </a>
          <a xlink:href="#" onclick="room(33)">
            <rect id="room-33" width="74.931343" height="96.578178" x="879.87463" y="939.81012" />
          </a>
          <a xlink:href="#" onclick="room(34)">
            <rect id="room-34" width="69.935921" height="96.578178" x="958.03076" y="813.55066" />
          </a>
          <a xlink:href="#" onclick="room(35)">
            <rect id="room-35" width="69.935921" height="96.578178" x="958.09943" y="939.9248" />
          </a>
          <a xlink:href="#" onclick="room(36)">
            <rect id="room-36" width="69.935921" height="96.578178" x="1178.066" y="813.4726" />
          </a>
          <a xlink:href="#" onclick="room(37)">
            <rect id="room-37" width="69.935921" height="96.578178" x="1177.9973" y="939.84674" />
          </a>
          <a xlink:href="#" onclick="room(38)">
            <rect id="room-38" width="76.318962" height="96.578178" x="1329.4949" y="813.59814" />
          </a>
          <a xlink:href="#" onclick="room(39)">
            <rect id="room-39" width="74.931343" height="96.578178" x="1252.2222" y="939.73206" />
          </a>
          <a xlink:href="#" onclick="room(40)">
            <rect id="room-40" width="76.318962" height="96.578178" x="1329.1877" y="939.59906" />
          </a>
          <a xlink:href="#" onclick="room(41)">
            <rect id="room-41" width="76.318962" height="96.578178" x="1005.3192" y="548.14319" />
          </a>
          <a xlink:href="#" onclick="room(42)">
            <rect id="room-42" width="76.318962" height="96.578178" x="1005.0121" y="422.14227" />
          </a>
          <a xlink:href="#" onclick="room(43)">
            <rect id="room-43" width="74.931343" height="96.578178" x="1084.2845" y="548.27618" />
          </a>
          <a xlink:href="#" onclick="room(44)">
            <rect id="room-44" width="69.935921" height="96.578178" x="1162.4407" y="422.01672" />
          </a>
          <a xlink:href="#" onclick="room(45)">
            <rect id="room-45" width="69.935921" height="96.578178" x="1162.5094" y="548.39087" />
          </a>
          <a xlink:href="#" onclick="room(46)">
            <rect id="room-46" width="69.935921" height="96.578178" x="1382.476" y="421.93866" />
          </a>
          <a xlink:href="#" onclick="room(47)">
            <rect id="room-47" width="69.935921" height="96.578178" x="1382.4072" y="548.31281" />
          </a>
          <a xlink:href="#" onclick="room(48)">
            <rect id="room-48" width="76.318962" height="96.578178" x="1533.9048" y="422.06421" />
          </a>
          <a xlink:href="#" onclick="room(49)">
            <rect id="room-49" width="74.931343" height="96.578178" x="1456.6321" y="548.19812" />
          </a>
          <a xlink:href="#" onclick="room(50)">
            <rect id="room-50" width="76.318962" height="96.578178" x="1533.5977" y="548.06512" />
          </a>
          <a xlink:href="#" onclick="room(51)">
            <rect id="room-51" width="76.318962" height="96.578178" x="1209.1758" y="161.82101" />
          </a>
          <a xlink:href="#" onclick="room(52)">
            <rect id="room-52" width="76.318962" height="96.578178" x="1208.8687" y="35.82011" />
          </a>
          <a xlink:href="#" onclick="room(53)">
            <rect id="room-53" width="74.931343" height="96.578178" x="1288.1414" y="161.95401" />
          </a>
          <a xlink:href="#" onclick="room(54)">
            <rect id="room-54" width="69.935921" height="96.578178" x="1366.2975" y="35.694561" />
          </a>
          <a xlink:href="#" onclick="room(55)">
            <rect id="room-55" width="69.935921" height="96.578178" x="1366.3661" y="162.0687" />
          </a>
          <a xlink:href="#" onclick="room(56)">
            <rect id="room-56" width="69.935921" height="96.578178" x="1586.3328" y="35.616497"/>
          </a>
          <a xlink:href="#" onclick="room(57)">
            <rect id="room-57" width="69.935921" height="96.578178" x="1586.264" y="161.99063"  />
          </a>
          <a xlink:href="#" onclick="room(58)">
            <rect id="room-58" width="76.318962" height="96.578178" x="1737.7616" y="35.742046"  />
          </a>
          <a xlink:href="#" onclick="room(59)">
            <rect id="room-59" width="74.931343" height="96.578178" x="1660.4889" y="161.87595"  />
          </a>
          <a xlink:href="#" onclick="room(60)">
            <rect id="room-60" width="76.318962" height="96.578178" x="1737.4545" y="161.74295" />
          </a>
          <!--a xlink:href="#" onclick="room(16)">
            <rect id="rect1-46" width="74.931343" height="96.578178" x="181.1973" y="813.62152" />
          </a-->
          <!--a xlink:href="#" onclick="room(5)">
            <rect id="rect1-46-2" width="74.931343" height="96.578178" x="-626.84271" y="813.54346" transform="scale(-1,1)" />
          </a-->
          <!--a xlink:href="#" onclick="room(2)">
            <rect id="rect1-46-7" width="74.931343" height="96.578178" x="589.46399" y="35.765423" />
          </a-->
          <!--a xlink:href="#" onclick="room(8)">
            <rect id="rect1-46-2-9" width="74.931343" height="96.578178" x="-1035.1094" y="35.687359" transform="scale(-1,1)" />
          </a-->
          <!--a xlink:href="#" onclick="room(4)">
            <rect id="rect1-46-0-5" width="74.931343" height="96.578178" x="1288.4923" y="35.742718" />
          </a-->
          <!--a xlink:href="#" onclick="room(10)">
            <rect id="rect1-46-2-4-6" width="74.931343" height="96.578178" x="-1734.1378" y="35.664654" transform="scale(-1,1)" />
          </a-->
          <!--a xlink:href="#" onclick="room(1)">
            <rect id="rect1-46-0" width="74.931343" height="96.578178" x="880.22565" y="813.59882" />
          </a-->
          <!--a xlink:href="#" onclick="room(7)">
            <rect id="rect1-46-2-4" width="74.931343" height="96.578178" x="-1325.8711" y="813.52075" transform="scale(-1,1)" />
          </a-->
          <!--a xlink:href="#" onclick="room(2)">
            <rect id="rect1-46-26" width="74.931343" height="96.578178" x="385.60739" y="422.08759" />
          </a-->
          <!--a xlink:href="#" onclick="room(8)">
            <rect id="rect1-46-2-8" width="74.931343" height="96.578178" x="-831.25281" y="422.00952" transform="scale(-1,1)" />
          </a-->
          <!--a xlink:href="#" onclick="room(4)">
            <rect id="rect1-46-0-0" width="74.931343" height="96.578178" x="1084.6356" y="422.06488" />
          </a-->
          <!--a xlink:href="#" onclick="room(10)">
            <rect id="rect1-46-2-4-9" width="74.931343" height="96.578178" x="-1530.281" y="421.98682" transform="scale(-1,1)" />
          </a-->
        </g>
      </svg>
    </div>
    <!-- Include Bootstrap JS (Popper.js and Bootstrap) -->
    <script src="../scripts/popper.min.js"></script>
    <script src="../scripts/bootstrap.min.js"></script>
    <script src="../scripts/header.js"></script>
    <script src="../scripts/searchbar.js"></script>
    <script>
      const rooms = document
        .querySelector("#layer1")
        .getElementsByTagName("rect");
      const modalContainer = document.querySelector(".modal-container");

      const roomNumber = document.querySelector("#room-info .room-number");
      const roomID = document.querySelector("#room-info .room-id");
      const roomType = document.querySelector("#room-info .room-type");
      const roomPhone = document.querySelector("#room-info .room-phone");
      const roomLan = document.querySelector("#room-info .room-lan");
      const roomComments = document.querySelector("#room-info .room-comments");

      const person1Card = document.querySelector("#person-1");
      const person1Name = document.querySelector("#person-1 .person-name");
      const person1Dept = document.querySelector("#person-1 .person-dept");
      const person1Tel = document.querySelector("#person-1 .person-tel");
      const person1Email = document.querySelector("#person-1 .person-email");
      const person1Comments = document.querySelector(
        "#person-1 .person-comments"
      );

      const person2Card = document.querySelector("#person-2");
      const person2Name = document.querySelector("#person-2 .person-name");
      const person2Dept = document.querySelector("#person-2 .person-dept");
      const person2Tel = document.querySelector("#person-2 .person-tel");
      const person2Email = document.querySelector("#person-2 .person-email");
      const person2Comments = document.querySelector(
        "#person-2 .person-comments"
      );

      modalContainer.addEventListener("click", (event) => {
        if (event.target === modalContainer) {
          modalContainer.style.display = "none";
        }
      });

      window.electronAPI.roomsOccupancy();
      window.electronAPI.roomsOccupancyList((event, data) => {
        const occupancy = data["occupancy"];
        const type = data["type"];
        const comments = data["comments"];

        for (var i in occupancy) {
          const x = rooms[i].getAttribute("x");
          const y = rooms[i].getAttribute("y");
          let text = document.createElementNS(
            "http://www.w3.org/2000/svg",
            "text"
          );
          text.setAttribute("x", parseFloat(x) + 24);
          text.setAttribute("y", parseFloat(y) + 48);
          if (parseInt(i) < 30) text.innerHTML = "A" + (parseInt(i) + 1);
          else text.innerHTML = "B" + (parseInt(i) - 29);
          rooms[i].insertAdjacentElement("afterend", text);

          if (comments[i] === 1) rooms[i].style.fill = "#eea340";
          else if (occupancy[i] === 0) rooms[i].style.fill = "#999999";
          else if (type[i] === "Δ" && occupancy[i] < 2)
            rooms[i].style.fill = "#0066a7";
          else rooms[i].style.fill = "#0ea700";
        }
      });

      function room(id) {
        window.electronAPI.roomSelected(id);
      }

      window.electronAPI.peopleList((event, data) => {
        modalContainer.style.display = "flex";
        if (data.length > 0) {
          roomData = data[0];
          let building;
          if ((roomData.number - 1) / 30 < 1) building = "Α";
          else building = "Β";
          roomNumber.innerHTML =
            "Στοιχεία Δωματίου " + building + roomData.number + ":";
          roomID.innerHTML = "α/α: " + roomData.id;
          roomType.innerHTML = "Τύπος: " + roomData.type;
          roomPhone.innerHTML = "Τηλέφωνο: " + roomData.phone;
          roomLan.innerHTML = "Πρίζα internet: " + roomData.lan;
          roomComments.innerHTML = "Σχόλια: " + roomData.comments;
        }

        if (data.length > 1) {
          person1 = data[1];
          person1Name.innerHTML = person1.surname + " " + person1.name;
          person1Dept.innerHTML = person1.department + " - " + person1.am;
          person1Tel.innerHTML =
            "Τηλ.: " + person1.phone + " - " + person1.phoneSecondary;
          person1Email.innerHTML = "Email: " + person1.email;
          person1Comments.innerHTML = "Σχόλια: " + person1.comments;
          person1Card.style.display = "block";
        } else {
          person1Card.style.display = "none";
        }

        if (data.length > 2) {
          person1 = data[2];
          person2Name.innerHTML = person1.surname + " " + person1.name;
          person2Dept.innerHTML = person1.department + " - " + person1.am;
          person2Tel.innerHTML =
            "Τηλ.: " + person1.phone + " - " + person1.phoneSecondary;
          person2Email.innerHTML = "Email: " + person1.email;
          person2Comments.innerHTML = "Σχόλια: " + person1.comments;
          person2Card.style.display = "block";
        } else {
          person2Card.style.display = "none";
        }
        window.electronAPI.removeListenerPeopleList();
      });

      window.electronAPI.canReceive();
    </script>
  </body>
</html>
